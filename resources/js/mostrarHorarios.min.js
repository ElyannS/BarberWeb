$(document).ready(function(){function s(e,a,o){$.ajax({url:"/BarberWeb/admin/mostrar_horarios",type:"POST",data:{data:e,tempoServico:a,idServico:o},dataType:"json",success:function(e){e=e.horarios;$(".itensHorarios").empty(),$.each(e,function(a,o){var e=0<o.horarios.length?o.horarios.map(e=>`<span class="span" value="${a},${o.idBarbeiro},${o.idServico},${o.data},${o.nomeServico},${e}">${e}</span>`).join(""):'<p class="sem-horarios">Nenhum horário disponível</p>',e=`
                            <div class="item">
                                <div class="nomeBarbeiro">
                                    <img src="http://exclusivebarbershop.com.br/${o.foto_usuario}">
                                    <p>${a}</p>
                                </div>
                                <div class="horariosBarbeiros" id="pegaDados">
                                    ${e}
                                </div>
                            </div>
                        `;$(".itensHorarios").append(e)})},error:function(e,a,o){if(e.responseText)try{var t=JSON.parse(e.responseText);t.hasOwnProperty("error")?alert("Erro: "+t.error):alert("Ocorreu um erro na requisição.")}catch(e){alert("Ocorreu um erro na requisição: "+o)}else alert("Ocorreu um erro na requisição: "+o)}})}"/BarberWeb/admin/agenda-cliente"===window.location.pathname&&($("#mostrarHorarios").on("click",function(){var e,a,o=$("#dataCliente").val(),t=$("#servicoCliente").val(),r=($("#valueIn").val("CHANGE"),new Date((new Date).toLocaleString("en-US",{timeZone:"America/Sao_Paulo"}))),r=(r.setHours(0,0,0,0),r.toISOString().split("T")[0]),i=$("#dataLibera").val();o&&i&&(a=new Date(o),new Date(i)<=a?(e="<p>Permitido somente até "+function(e){var e=new Date(e),a=e.getDate(),o=e.getMonth()+1,e=e.getFullYear();a<10&&(a="0"+a);o<10&&(o="0"+o);return a+"-"+o+"-"+e}(i)+"!</p>",$(".alertaAviso").empty(),$(".alertaAviso").append(e),$(".alertaAviso").addClass("mostrar"),$(".itensHorarios").empty(),setTimeout(function(){$(".alertaAviso").removeClass("mostrar"),$(".alertaAviso").empty()},5e3)):o<r?(e="<p>Selecione uma data válida!</p>",$(".alertaAviso").empty(),$(".alertaAviso").append(e),$(".alertaAviso").addClass("mostrar"),setTimeout(function(){$(".alertaAviso").removeClass("mostrar"),$(".alertaAviso").empty()},5e3)):"sel"===t?(e="<p>Selecione um serviço!</p>",$(".alertaAviso").empty(),$(".alertaAviso").append(e),$(".alertaAviso").addClass("mostrar"),setTimeout(function(){$(".alertaAviso").removeClass("mostrar"),$(".alertaAviso").empty()},5e3)):s(o,(a=t.split(";"))[0],a[1]))}),$("#servicoCliente").change(function(){var e,a,o,t,r,i;"CHANGE"==$("#valueIn").val()&&(e=$("#dataCliente").val(),a=$("#servicoCliente").val(),$("#valueIn").val("CHANGE"),(o=new Date((new Date).toLocaleString("en-US",{timeZone:"America/Sao_Paulo"}))).setHours(0,0,0,0),o=o.toISOString().split("T")[0],t=$("#dataLibera").val(),e)&&t&&(i=new Date(e),new Date(t)<=i?(r="<p>Permitido somente até "+function(e){var e=new Date(e),a=e.getDate(),o=e.getMonth()+1,e=e.getFullYear();a<10&&(a="0"+a);o<10&&(o="0"+o);return a+"-"+o+"-"+e}(t)+"!</p>",$(".alertaAviso").empty(),$(".alertaAviso").append(r),$(".alertaAviso").addClass("mostrar"),$(".itensHorarios").empty(),setTimeout(function(){$(".alertaAviso").removeClass("mostrar"),$(".alertaAviso").empty()},5e3)):e<o?(r="<p>Selecione uma data válida!</p>",$(".alertaAviso").empty(),$(".alertaAviso").append(r),$(".alertaAviso").addClass("mostrar"),setTimeout(function(){$(".alertaAviso").removeClass("mostrar"),$(".alertaAviso").empty()},5e3)):"sel"===a?(r="<p>Selecione um serviço!</p>",$(".alertaAviso").empty(),$(".alertaAviso").append(r),$(".alertaAviso").addClass("mostrar"),setTimeout(function(){$(".alertaAviso").removeClass("mostrar"),$(".alertaAviso").empty()},5e3)):s(e,(i=a.split(";"))[0],i[1]))}),$(document).on("click","#pegaDados span",function(){var e=$(this).attr("value"),[e,a,o,t,r,i]=($(".clienteAgenda").css("position","fixed"),$("body.admin .index").toggleClass("activeAgenda"),e.split(","));$("#nomeBarber").val(e),$("#idBaber").val(a),$("#nomeSevico").val(r),$("#idServ").val(o),$("#dataAgen").val(t),$("#agendData").val(t),$("#horarioAgen").val(i),$("#horarioA").val(i)}),$(".closeAgenda").on("click",function(){$("body.admin .index").toggleClass("activeAgenda"),$(".agenda").css("position","initial")}))});