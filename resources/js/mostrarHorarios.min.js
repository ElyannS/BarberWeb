$(document).ready(function(){function s(e,a,t){$.ajax({url:"/BarberWeb/admin/mostrar_horarios",type:"POST",data:{data:e,tempoServico:a,idServico:t},dataType:"json",success:function(e){e=e.horarios;$(".itensHorarios").empty(),$.each(e,function(a,t){var e=`
                            <div class="item">
                                <div class="nomeBarbeiro">
                                    <img src="http://exclusivebarbershop.com.br/${t.foto_usuario}">
                                    <p>${a}</p>
                                </div>
                                <div class="horariosBarbeiros" id="pegaDados">
                                    ${t.horarios.map(e=>`<span class="span" value="${a},${t.idBarbeiro},${t.idServico},${t.data},${t.nomeServico},${e}">${e}</span>`).join("")}
                                </div>
                            </div>
                        `;$(".itensHorarios").append(e)})},error:function(e,a,t){if(e.responseText)try{var o=JSON.parse(e.responseText);o.hasOwnProperty("error")?alert("Erro: "+o.error):alert("Ocorreu um erro na requisição.")}catch(e){alert("Ocorreu um erro na requisição: "+t)}else alert("Ocorreu um erro na requisição: "+t)}})}"/BarberWeb/admin/agenda-cliente"===window.location.pathname&&($("#mostrarHorarios").on("click",function(){var e,a,t=$("#dataCliente").val(),o=$("#servicoCliente").val(),r=($("#valueIn").val("CHANGE"),new Date((new Date).toLocaleString("en-US",{timeZone:"America/Sao_Paulo"}))),r=(r.setHours(0,0,0,0),r.toISOString().split("T")[0]),i=$("#dataLibera").val();t&&i&&(a=new Date(t),new Date(i)<=a?(e="<p>Permitido somente até "+function(e){var e=new Date(e),a=e.getDate(),t=e.getMonth()+1,e=e.getFullYear();a<10&&(a="0"+a);t<10&&(t="0"+t);return a+"-"+t+"-"+e}(i)+"!</p>",$(".alertaAviso").empty(),$(".alertaAviso").append(e),$(".alertaAviso").addClass("mostrar"),$(".itensHorarios").empty(),setTimeout(function(){$(".alertaAviso").removeClass("mostrar"),$(".alertaAviso").empty()},5e3)):t<r?(e="<p>Selecione uma data válida!</p>",$(".alertaAviso").empty(),$(".alertaAviso").append(e),$(".alertaAviso").addClass("mostrar"),setTimeout(function(){$(".alertaAviso").removeClass("mostrar"),$(".alertaAviso").empty()},5e3)):"sel"===o?(e="<p>Selecione um serviço!</p>",$(".alertaAviso").empty(),$(".alertaAviso").append(e),$(".alertaAviso").addClass("mostrar"),setTimeout(function(){$(".alertaAviso").removeClass("mostrar"),$(".alertaAviso").empty()},5e3)):s(t,(a=o.split(";"))[0],a[1]))}),$("#servicoCliente").change(function(){var e,a,t,o,r,i;"CHANGE"==$("#valueIn").val()&&(e=$("#dataCliente").val(),a=$("#servicoCliente").val(),$("#valueIn").val("CHANGE"),(t=new Date((new Date).toLocaleString("en-US",{timeZone:"America/Sao_Paulo"}))).setHours(0,0,0,0),t=t.toISOString().split("T")[0],o=$("#dataLibera").val(),e)&&o&&(i=new Date(e),new Date(o)<=i?(r="<p>Permitido somente até "+function(e){var e=new Date(e),a=e.getDate(),t=e.getMonth()+1,e=e.getFullYear();a<10&&(a="0"+a);t<10&&(t="0"+t);return a+"-"+t+"-"+e}(o)+"!</p>",$(".alertaAviso").empty(),$(".alertaAviso").append(r),$(".alertaAviso").addClass("mostrar"),$(".itensHorarios").empty(),setTimeout(function(){$(".alertaAviso").removeClass("mostrar"),$(".alertaAviso").empty()},5e3)):e<t?(r="<p>Selecione uma data válida!</p>",$(".alertaAviso").empty(),$(".alertaAviso").append(r),$(".alertaAviso").addClass("mostrar"),setTimeout(function(){$(".alertaAviso").removeClass("mostrar"),$(".alertaAviso").empty()},5e3)):"sel"===a?(r="<p>Selecione um serviço!</p>",$(".alertaAviso").empty(),$(".alertaAviso").append(r),$(".alertaAviso").addClass("mostrar"),setTimeout(function(){$(".alertaAviso").removeClass("mostrar"),$(".alertaAviso").empty()},5e3)):s(e,(i=a.split(";"))[0],i[1]))}),$(document).on("click","#pegaDados span",function(){var e=$(this).attr("value"),[e,a,t,o,r,i]=($(".clienteAgenda").css("position","fixed"),$("body.admin .index").toggleClass("activeAgenda"),e.split(","));$("#nomeBarber").val(e),$("#idBaber").val(a),$("#nomeSevico").val(r),$("#idServ").val(t),$("#dataAgen").val(o),$("#agendData").val(o),$("#horarioAgen").val(i),$("#horarioA").val(i)}),$(".closeAgenda").on("click",function(){$("body.admin .index").toggleClass("activeAgenda"),$(".agenda").css("position","initial")}))});