$(document).ready(function(){$(".js-example-basic-single").select2();var a,r;function e(a,r){$.ajax({url:"/BarberWeb/admin/gerar_horario",type:"POST",data:{data:a,idBarbeiro:r},dataType:"json",success:function(a){var r,e,a=a.horarios,o=($("#tabelaHorarios").empty(),$("<table></table>").addClass("horarios-table")),t=$("<tbody></tbody>");0<a.length&&a[0].turno1&&a[0].turno2?(r=a[0].turno1,e=a[0].turno2,"FECHADO"===r&&"FECHADO"===e?($("#aviso").empty(),$("#aviso").append("<p>Nenhum horário disponível!</p>"),$("#aviso").addClass("mostrar"),setTimeout(function(){$("#aviso").removeClass("mostrar"),$("#aviso").empty()},5e3)):(0<a.length&&a[0].turno1&&(r="FECHADO"===(r=a[0].turno1.trim())?[]:r.split(", ")).forEach(function(a){var r="horario-"+a.replace(":","-"),e=$("<tr></tr>"),a=$("<th></th>").addClass("tr").text(a),a=(e.append(a),$("<td></td>")),r=$("<div></div>").addClass("td selectTd").attr("id",r);a.append(r),e.append(a),t.append(e)}),0<a.length&&a[0].turno2&&(e="FECHADO"===(e=a[0].turno2.trim())?[]:e.split(", ")).forEach(function(a){var r="horario-"+a.replace(":","-"),e=$("<tr></tr>"),a=$("<th></th>").addClass("tr").text(a),a=(e.append(a),$("<td></td>")),r=$("<div></div>").addClass("td").attr("id",r);a.append(r),e.append(a),t.append(e)}),o.append(t),$("#tabelaHorarios").append(o))):console.log("Horários não encontrados ou formato inválido.")},error:function(a,r,e){alert("Ocorreu um erro na requisição: "+e)}})}function o(a,r){$.ajax({url:"/BarberWeb/admin/atualizar_data",type:"POST",data:{data:a,idBarbeiro:r},dataType:"json",success:function(a){for(var r=a.horarios,e=0;e<r.length;e++){var o=r[e].horario,t=r[e].nome,n=r[e].idAgendamento,i=r[e].servico,o=$("#horario-"+o.replace(":","-").replace(" ","-")),i=(t&&(o.addClass("marcado"),"Corte e barba"==i)&&o.addClass("marcado-corte-barba"),$("<a></a>"));i.attr("href","agendamentos-edit/"+n),i.text(t),o.append(i)}},error:function(a,r,e){if(a.responseText)try{var o=JSON.parse(a.responseText);o.hasOwnProperty("error")?alert("Erro: "+o.error):alert("Ocorreu um erro na requisição.")}catch(a){alert("Ocorreu um erro na requisição: "+e)}else alert("Ocorreu um erro na requisição: "+e)}})}"/BarberWeb/admin/agendamentos"===window.location.pathname&&($("#dataMarcada").change(function(){var a=$("#dataMarcada").val(),r=$("#idBarbeiro").val();e(a,r),setTimeout(function(){o(a,r)},200)}),$("#idBarbeiro").change(function(){var a=$("#dataMarcada").val(),r=$("#idBarbeiro").val();e(a,r),setTimeout(function(){o(a,r)},200)}),a=$("#dataMarcada").val(),r=$("#idBarbeiro").val(),e(a,r),setTimeout(function(){o(a,r)},200))});