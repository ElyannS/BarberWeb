$(document).ready(function(){$(".js-example-basic-single").select2();var a,r,e;function t(a,r){$.ajax({url:"/admin/gerar_horario",type:"POST",data:{data:a,idBarbeiro:r},dataType:"json",success:function(a){var r,e,a=a.horarios,t=($("#tabelaHorarios").empty(),$("<table></table>").addClass("horarios-table")),o=$("<tbody></tbody>");0<a.length&&a[0].turno1&&a[0].turno2?(r=a[0].turno1,e=a[0].turno2,"FECHADO"===r&&"FECHADO"===e?($("#aviso").empty(),$("#aviso").append("<p>Nenhum horário disponível!</p>"),$("#aviso").addClass("mostrar"),setTimeout(function(){$("#aviso").removeClass("mostrar"),$("#aviso").empty()},5e3)):(0<a.length&&a[0].turno1&&(r="FECHADO"===(r=a[0].turno1.trim())?[]:r.split(", ")).forEach(function(a){var r="horario-"+a.replace(":","-"),e=$("<tr></tr>"),a=$("<th></th>").addClass("tr").text(a),a=(e.append(a),$("<td></td>")),r=$("<div></div>").addClass("td selectTd").attr("id",r);a.append(r),e.append(a),o.append(e)}),0<a.length&&a[0].turno2&&(e="FECHADO"===(e=a[0].turno2.trim())?[]:e.split(", ")).forEach(function(a){var r="horario-"+a.replace(":","-"),e=$("<tr></tr>"),a=$("<th></th>").addClass("tr").text(a),a=(e.append(a),$("<td></td>")),r=$("<div></div>").addClass("td").attr("id",r);a.append(r),e.append(a),o.append(e)}),t.append(o),$("#tabelaHorarios").append(t))):console.log("Horários não encontrados ou formato inválido.")},error:function(a,r,e){alert("Ocorreu um erro na requisição: "+e)}})}function o(a,r){$.ajax({url:"/admin/atualizar_data",type:"POST",data:{data:a,idBarbeiro:r},dataType:"json",success:function(a){for(var r=a.horarios,e=0;e<r.length;e++){var t=r[e].horario,o=r[e].nome,n=r[e].idAgendamento,i=r[e].servico,t=$("#horario-"+t.replace(":","-").replace(" ","-")),i=(o&&(t.addClass("marcado"),"Corte e barba"==i)&&t.addClass("marcado-corte-barba"),$("<a></a>"));i.attr("href","agendamentos-edit/"+n),i.text(o),t.append(i)}},error:function(a,r,e){if(a.responseText)try{var t=JSON.parse(a.responseText);t.hasOwnProperty("error")?alert("Erro: "+t.error):alert("Ocorreu um erro na requisição.")}catch(a){alert("Ocorreu um erro na requisição: "+e)}else alert("Ocorreu um erro na requisição: "+e)}})}"/admin/agendamentos"===window.location.pathname&&($("#dataMarcada").change(function(){var a=$("#dataMarcada").val(),r=$("#idBarbeiro").val();t(a,r),setTimeout(function(){o(a,r)},200)}),$("#idBarbeiro").change(function(){var a=$("#dataMarcada").val(),r=$("#idBarbeiro").val();t(a,r),setTimeout(function(){o(a,r)},200)}),a=$("#dataMarcada").val(),e=$("#idBarbeiro").val(),t(a,e),setTimeout(function(){o(a,e)},200),r=$("#dataMarcada").val(),e=$("#idBarbeiro").val(),setTimeout(function(){o(r,e)},100))});